add-additional-myprojects-tests, development
diff --git a/Gemfile b/Gemfile
index 2a3eab8..c295989 100644
--- a/Gemfile
+++ b/Gemfile
@@ -47,6 +47,7 @@ group :test do
   gem 'database_cleaner'
   gem 'timecop'
   gem 'launchy'
+  gem 'simplecov', :require => false
 end
 
 group :production do
@@ -67,6 +68,3 @@ end
 
 # Use Capistrano for deployment
 # gem 'capistrano-rails', group: :development
-
-
-
diff --git a/db/github_mock_login.yml b/db/github_mock_login.yml
index a8debfe..ebe8e8c 100644
--- a/db/github_mock_login.yml
+++ b/db/github_mock_login.yml
@@ -2,7 +2,7 @@ development:
   github_uid: 'fox'
   name: 'Armando Fox'
   email: 'fox@cs.berkeley.edu'
-  user_type: 'coach'
+  user_type: 'client'
 test:
   github_uid: "esaas_developer"
   name: "ESaas Developer"
diff --git a/db/schema.rb b/db/schema.rb
index 08a455c..619e498 100644
--- a/db/schema.rb
+++ b/db/schema.rb
@@ -13,18 +13,20 @@
 
 ActiveRecord::Schema.define(version: 20191112010952) do
 
-  create_table "app_edit_requests", primary_key: "app_id", force: :cascade do |t|
+  create_table "app_edit_requests", force: :cascade do |t|
     t.text     "description"
     t.text     "features"
     t.text     "feedback"
     t.integer  "status",        default: 0, null: false
     t.datetime "approval_time"
+    t.integer  "app_id",                    null: false
     t.integer  "requester_id",              null: false
     t.integer  "approver_id"
     t.datetime "created_at",                null: false
     t.datetime "updated_at",                null: false
   end
 
+  add_index "app_edit_requests", ["app_id"], name: "index_app_edit_requests_on_app_id"
   add_index "app_edit_requests", ["approver_id"], name: "index_app_edit_requests_on_approver_id"
   add_index "app_edit_requests", ["requester_id"], name: "index_app_edit_requests_on_requester_id"
 
diff --git a/features/my_approval_requests.feature b/features/my_approval_requests.feature
index a884e7e..4711328 100644
--- a/features/my_approval_requests.feature
+++ b/features/my_approval_requests.feature
@@ -1,8 +1,7 @@
 Feature: staff should be able to approve or comment on requested feature changes or additions made by a user
   As a logged in Coach user on ESaaS Engagements
-  I should see a tab labeled “App Edit Requests”
+  I should see a tab labeled "App Edit Requests"
   So that I can approve of or give feedback on requested feature changes or new features on existing apps made by users
-
   Background: seed data and log in
     Given the following apps exist:
       | id  | name  | description | org_id | status      | pivotal_tracker_url | repository_url | deployment_url  | features |
@@ -12,102 +11,88 @@ Feature: staff should be able to approve or comment on requested feature changes
       | 104 | app4  | test4       | 4      | pending     | p3.com              | repo-url3.com  | deploy-url3.com | f3       |
       | 105 | app5  | test5       | 3      | development | p4.com              | repo-url4.com  | deploy-url3.com | f5       |
       | 106 | app6  | test6       | 3      | pending     | p5.com              | repo-url5.com  | deploy-url3.com | f6       |
-
     And the following orgs exist:
       | id | name | contact_id |
       | 1  | org1 | 2          |
       | 2  | org2 | 2          |
       | 3  | org3 | 1          |
       | 4  | org4 | 2          |
-
     And the following App Edit Requests exist:
       | id | description  | features    | feedback | status      | approval_time | app_id | requester_id    | approver_id | created_at                 | updated_at |
       | 1  | app1         | test1       |          | submitted   |               | 101    | 2               |             | 2019-11-20 7:44:50 -0800   |            |
       | 2  | app2         | test2       |          | submitted   |               | 102    | 2               |             | 2019-11-20 08:05:50 -0800  |            |
-
-
+      | 2  | app6         | test3       |          | reviewed    |               | 106    | 2               |             | 2019-11-20 08:05:50 -0800  |            |
     And the following users exist:
       | id | name  | github_uid      | email          | user_type     |
       | 1  | user1 | esaas_developer | test@user.com  | coach         |
       | 2  | user2 | mock_user1      | test1@user.com | client        |
       | 3  | user3 |                 | test2@user.com | student       |
       | 4  | user4 |                 | test4@user.com | client        |
-
 # ---------------------------- Menu bar ----------------------------------------
 Scenario: A user that is not logged in cannot see 'App Edit Requests' tab
 Given I am not logged in
 Then I should not see "App Edit Requests"
-
 Scenario: A logged in user that is not a Coach cannot see 'App Edit Requests' tab
 #  Given I am logged in
 #  Then I should not see "App Edit Requests"
-
 Scenario: A logged in user that is a Coach can see the 'App Edit Requests' tab
 Given I am logged in
 Then I should see "App Edit Requests"
-
 # ------ Previously: App Edit Requests Index -- Currently: MyApprovalRequests Index -------
-
 Scenario: A logged in coach user can see list of App Edit Requests in 'App Edit Requests' tab
   Given I am logged in
-  When I follow "App Edit Requests"
+  When I follow "App Edit Requests 2"
   Then I should see "app1" before "app2"
   And I should not see "app4"
   And I should not see "app3"
-
 # -------------------- App Edit Request Show Page -----------------------------
 Scenario: A logged in coach user can view an App Edit (Feature Change) Request through the 'App Edit Requests' index
   Given I am logged in
   When I follow "App Edit Requests"
   When I follow the App Edit Request with id 102
   Then I should see /Edit request for "app2"/
-
-Scenario: A coach user requests an edit on his/her project and verifies that 
-          approving the request via the App Edit Requests page correctly 
-          updates the approval status of the request in the  project information page 
-
+Scenario: A coach user requests an edit on his/her project and verifies that
+          approving the request via the App Edit Requests page correctly
+          updates the approval status of the request in the  project information page
   Given I am logged in
+  Then I should see "App Edit Requests 2"
   When I follow "My Projects"
   Then I should be on the my projects page
   When I follow "app5"
   Then I should not see "Your app edit request has been submitted to staff for review and approval. Staff has not yet reviewed/approved this request."
   When I follow "Back"
-
   And I follow Request Change with id 105
   Then I should see "There are currently no edit requests for your app. You can request new edits for you app here."
   When I fill in "description" with "This is app5"
   And I fill in "features" with "login, logout"
   Then I press "Send Request"
   Then I should see "Your app edit request has been submitted to staff for review and approval. Staff has not yet reviewed/approved this request."
-
+  Then I should see "App Edit Requests 3"
   When I follow "App Edit Requests"
   Then I should see "app1"
   Then I should see "app2"
   Then I should see "app5"
-
   And I follow the App Edit Request with id 105
   Then I should see "This is app5"
   And I should see "login, logout"
   When I fill in "feedback" with "I can only do login"
   And I press "Post Feedback"
+  Then I should see "App Edit Requests 2"
   And I follow the App Edit Request with id 105
   Then I should see "reviewed"
-
   When I follow "My Projects"
   Then I should be on the my projects page
   When I follow "app5"
   Then I should see "Staff has reviewed and left feedback on your edit request. Kindly review staff feedback and update the request."
   And I should see "I can only do login"
-
   Given I follow "Update Edits"
   When I press "Update Request"
   Then I should see "There were no updates to edits made."
-
   Given I fill in "features" with "login"
   And I press "Update Request"
   Then I should see "Successfully updated edit request."
   And I should see "You resubmitted an edit request after staff left feedback but staff has not yet reviewed your updates."
-
+  Then I should see "App Edit Requests 3"
   When I follow "App Edit Requests"
   Then I should see "app1"
   Then I should see "app5"
@@ -118,11 +103,27 @@ Scenario: A coach user requests an edit on his/her project and verifies that
   And I uncheck "submitted"
   Then I press "Filter Requests"
   Then I should not see "app1"
-  
   And I follow the App Edit Request with id 105
   And I press "Post Feedback and Approve"
   Then I should see /You have successfully approved edits for "app5"./
+  Then I should see "App Edit Requests 2"
   And I press "Filter Requests"
   Then I should not see "app5"
-
-  
\ No newline at end of file
+Scenario: Client can view and link to reviewed requests through icon dropdown menu
+  Given I am logged in
+  When I follow "My Projects"
+  Then I should see "Your request has been reviewed!"
+  When I click on the "requests" icon
+  Then I should see "View Request Feedback for app6"
+  And I should not see "View Request Feedback for app1"
+  When I follow "View Request Feedback for app6"
+  Then I should see "Edit Request for app6"
+  Then I should see "Feedback"
+  Given I follow "Update Edits"
+  Then I should see /Request Changes for "'app6'"/
+  When I fill in "features" with "123"
+  And I press "Update Request"
+  Then I should see "123"
+  Then I should see "App Edit Requests 3"
+  When I follow "My Projects"
+  Then I should not see "Your request has been reviewed!"
diff --git a/features/myprojects.feature b/features/myprojects.feature
index a3a9ed8..823b1ce 100644
--- a/features/myprojects.feature
+++ b/features/myprojects.feature
@@ -60,7 +60,7 @@
    Then I should see "p1.com"
    Then I should see "repo-url1.com"
    Then I should see "deploy-url1.com"
-   
+
  Scenario: A logged in user can see buttons on the Projects Information Page through the 'My Projects' index
    Given I am logged in
    When I follow "My Projects"
@@ -127,3 +127,16 @@
    Then I should see "p1.com"
    Then I should see "repo-url1.com"
    Then I should see "deploy-url1.com"
+
+   Scenario: A logged-in client can delete a Change Request on the Update/Edit Request Page
+   Given I am logged in
+   When I follow "My Projects"
+   And I follow "app1"
+   And I follow "Request Change"
+   And I fill in "description" with "123abc"
+   And I fill in "features" with "123abc"
+   And I press "Send Request"
+   Then I should see "Update Request"
+   When I follow "Update Request"
+   And I press "Delete Request"
+   Then I should see "Successfully deleted edit request for: app1"
diff --git a/features/step_definitions/my_projects_steps.rb b/features/step_definitions/my_projects_steps.rb
index 747efe0..2d23b38 100644
--- a/features/step_definitions/my_projects_steps.rb
+++ b/features/step_definitions/my_projects_steps.rb
@@ -1,3 +1,7 @@
 When /^(?:|I )follow Request Change with id (.+)$/ do |id|
     visit new_my_project_edit_path(app_id: id)
-  end
\ No newline at end of file
+  end
+
+# When /I click on the “(.+)” icon/ do |locator|
+#   find(‘#’ + locator).click
+# end
diff --git a/spec/rails_helper.rb b/spec/rails_helper.rb
index cb52f14..ef1939f 100644
--- a/spec/rails_helper.rb
+++ b/spec/rails_helper.rb
@@ -1,4 +1,5 @@
 require 'simplecov'
+SimpleCov.start 'rails'
 # This file is copied to spec/ when you run 'rails generate rspec:install'
 ENV['RAILS_ENV'] ||= 'test'
 require File.expand_path('../../config/environment', __FILE__)

--
1	3	Gemfile
1	1	db/github_mock_login.yml
3	1	db/schema.rb
29	28	features/my_approval_requests.feature
14	1	features/myprojects.feature
5	1	features/step_definitions/my_projects_steps.rb
1	0	spec/rails_helper.rb
